# Feature: 4.1.1 TUI Application Module Setup

## Problem Statement

Task 4.1.1 requires creating the main TUI module implementing the TermUI.Elm behaviour. This is the foundation for the terminal user interface that will connect to the agent system.

## Solution Overview

Create `JidoCode.TUI` module that:
1. Uses `TermUI.Elm` behaviour from term_ui hex package (0.1.0)
2. Defines a `Model` struct for application state
3. Implements required callbacks: `init/1`, `event_to_msg/2`, `update/2`, `view/1`
4. Loads settings and subscribes to PubSub
5. Provides `run/0` function to start the TUI

### API Reference (hexdocs.pm/term_ui/0.1.0)

```elixir
# Required callbacks
@callback init(opts :: keyword()) :: state()
@callback event_to_msg(Event.t(), state()) :: {:msg, msg()} | :ignore | :propagate
@callback update(msg(), state()) :: {state(), [command()]} | {state()} | :noreply
@callback view(state()) :: render_tree()

# Starting the TUI
TermUI.Runtime.run(root: JidoCode.TUI)
```

## Implementation Plan

### Step 1: Update dependencies
- [x] 1.1 Update mix.exs to use term_ui from hex.pm 0.1.0

### Step 2: Create TUI module
- [x] 2.1 Create `lib/jido_code/tui.ex` with `use TermUI.Elm`
- [x] 2.2 Define `Model` struct with required fields
- [x] 2.3 Implement `init/1` callback
- [x] 2.4 Load settings and populate config
- [x] 2.5 Subscribe to PubSub topic "tui.events"
- [x] 2.6 Implement basic `event_to_msg/2` (return :ignore for now)
- [x] 2.7 Implement basic `update/2` (return state unchanged)
- [x] 2.8 Implement basic `view/1` (render placeholder)
- [x] 2.9 Add `run/0` function

### Step 3: Update Application module
- [x] 3.1 Update moduledoc to reflect TUI is not auto-started
- [x] 3.2 Add comment about how to start TUI

### Step 4: Write tests
- [x] 4.1 Test Model struct creation
- [x] 4.2 Test init/1 returns proper initial state
- [x] 4.3 Test determine_status/1 logic
- [x] 4.4 Test event_to_msg/2 returns :ignore for unknown events

### Step 5: Verify
- [x] 5.1 Run `mix compile` successfully
- [x] 5.2 Run `mix test` - all tests pass

## Technical Notes

### Model Struct Fields

```elixir
defmodule Model do
  defstruct [
    :input_buffer,      # Current text being typed
    :messages,          # Conversation history
    :agent_status,      # :idle | :processing | :error | :unconfigured
    :config,            # %{provider: String.t(), model: String.t()}
    :reasoning_steps,   # Chain-of-Thought progress
    :window             # Terminal dimensions {width, height}
  ]
end
```

### Agent Status States

- `:unconfigured` - No provider/model set (initial state if settings empty)
- `:idle` - Ready for input
- `:processing` - Agent is working
- `:error` - Last operation failed

## Success Criteria

1. `JidoCode.TUI` module compiles without errors
2. `JidoCode.TUI.run()` can be called (will be tested manually)
3. Model struct has all required fields
4. init/1 loads settings correctly
5. All tests pass

## Current Status

**Status**: Complete
