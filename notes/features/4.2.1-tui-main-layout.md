# Feature: 4.2.1 TUI Main Layout Structure

## Problem Statement

Task 4.2.1 requires implementing the primary view function with a three-pane layout: status bar at top, conversation area in the middle, and input bar at bottom. The layout must be responsive to terminal resize events and apply appropriate styling.

## Solution Overview

### Layout Architecture

The TUI uses a vertical stack layout with three sections:

```
┌──────────────────────────────────────┐
│ Status Bar (1 line)                  │  <- Provider:Model | Status | Hints
├──────────────────────────────────────┤
│                                      │
│ Conversation Area (flexible)         │  <- Message history
│                                      │
├──────────────────────────────────────┤
│ Input Bar (1 line)                   │  <- "> " + input_buffer
└──────────────────────────────────────┘
```

### TermUI Components Used

Using TermUI.Component.Helpers:
- `text/1`, `text/2` - Text nodes with optional styling
- `stack/2` - Vertical/horizontal stacking

Using TermUI.Renderer.Style:
- `Style.new/1` - Create style with fg, bg, attrs options

## Implementation Plan

### Step 1: Enhance Status Bar
- [x] 1.1 Display provider:model with colored status indicators
- [x] 1.2 Show status as colored text: idle (green), processing (yellow), error (red), unconfigured (red)
- [x] 1.3 Add keyboard shortcut hints on the right side
- [x] 1.4 Show CoT indicator when reasoning steps are present

### Step 2: Implement Conversation Area
- [x] 2.1 Create `render_conversation/1` helper function
- [x] 2.2 Display messages with role prefix ("You:" for user, "Assistant:" for assistant)
- [x] 2.3 Apply styling (user: cyan, assistant: white)
- [x] 2.4 Add timestamps to messages
- [x] 2.5 Show placeholder when no messages

### Step 3: Implement Input Bar
- [x] 3.1 Create `render_input_bar/1` helper function
- [x] 3.2 Display prompt indicator "> "
- [x] 3.3 Show current input buffer content
- [x] 3.4 Apply appropriate styling

### Step 4: Compose Main Layout
- [x] 4.1 Update `view/1` to use three-pane layout
- [x] 4.2 Ensure proper vertical stacking order
- [x] 4.3 Handle empty states gracefully

### Step 5: Update Tests
- [x] 5.1 Add tests for status bar content
- [x] 5.2 Add tests for conversation rendering
- [x] 5.3 Add tests for input bar rendering
- [x] 5.4 Verify layout structure

### Step 6: Verify
- [x] 6.1 Run `mix compile` successfully
- [x] 6.2 Run `mix test` - all tests pass

## Technical Notes

### Styling Rules

| Element | Foreground | Background | Attributes |
|---------|------------|------------|------------|
| Status Bar | :white | :blue | - |
| Status: Idle | :green | - | - |
| Status: Processing | :yellow | - | - |
| Status: Error | :red | - | - |
| Status: Unconfigured | :red | :dim | - |
| User Message | :cyan | - | - |
| Assistant Message | :white | - | - |
| Timestamp | :bright_black | - | - |
| Input Prompt | :green | - | :bold |
| Keyboard Hints | :bright_black | - | - |

### Message Format

```
[HH:MM] You: message content here
[HH:MM] Assistant: response content here
```

### Status Bar Format

```
provider:model | Status | Ctrl+M: Model | Ctrl+R: Reasoning | Ctrl+C: Quit
```

When unconfigured:
```
No provider configured | Not Configured | Ctrl+M: Model | Ctrl+C: Quit
```

## Success Criteria

1. Three-pane layout renders correctly
2. Status bar shows configuration and status
3. Messages display with proper styling
4. Input bar shows current buffer
5. Layout adapts to window dimensions
6. All tests pass

## Current Status

**Status**: Complete
