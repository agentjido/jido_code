# Feature: 4.2.3 TUI Reasoning Panel

## Problem Statement

Task 4.2.3 requires implementing an optional reasoning panel that shows Chain-of-Thought (CoT) reasoning steps during complex queries. The panel should be toggleable with Ctrl+R and positioned appropriately based on terminal width.

## Solution Overview

### Model Changes

Add `show_reasoning` boolean field to toggle the panel visibility:
- Default: `false` (hidden)
- Toggled with Ctrl+R

### Panel Display

The reasoning panel shows:
- List of reasoning steps with status indicators
- Status: pending (○), active (●), complete (✓)
- Currently executing step highlighted
- Confidence score when available

### Positioning

Based on terminal width:
- Wide terminals (>= 100 cols): Right sidebar
- Narrow terminals (< 100 cols): Bottom drawer

## Implementation Plan

### Step 1: Update Model
- [x] 1.1 Add `show_reasoning` boolean field (default: false)
- [x] 1.2 Update Model typespec

### Step 2: Add Event Handler
- [x] 2.1 Add event_to_msg handler for Ctrl+R → `:toggle_reasoning`
- [x] 2.2 Add update handler for `:toggle_reasoning`

### Step 3: Create Reasoning Panel Renderer
- [x] 3.1 Create `render_reasoning/1` helper function
- [x] 3.2 Display step list with status indicators
- [x] 3.3 Highlight active step
- [x] 3.4 Show panel header with step count

### Step 4: Update Main View
- [x] 4.1 Update view/1 to conditionally include reasoning panel
- [x] 4.2 Position as right sidebar for wide terminals
- [x] 4.3 Position as bottom drawer for narrow terminals

### Step 5: Write Tests
- [x] 5.1 Test show_reasoning in Model
- [x] 5.2 Test Ctrl+R event handling
- [x] 5.3 Test toggle_reasoning update handler
- [x] 5.4 Test reasoning panel rendering
- [x] 5.5 Test panel positioning based on width

### Step 6: Verify
- [x] 6.1 Run `mix compile` successfully
- [x] 6.2 Run `mix test` - all tests pass

## Technical Notes

### Status Indicators

| Status | Symbol | Style |
|--------|--------|-------|
| Pending | ○ | bright_black (dim) |
| Active | ● | yellow + bold |
| Complete | ✓ | green |

### Panel Layout

Wide terminal (>= 100 cols):
```
┌─────────────────────────────────┬──────────────────┐
│ Status Bar                      │ Reasoning (3)    │
├─────────────────────────────────┤ ✓ Step 1         │
│                                 │ ● Step 2         │
│ Conversation                    │ ○ Step 3         │
│                                 │                  │
├─────────────────────────────────┴──────────────────┤
│ > input                                            │
└────────────────────────────────────────────────────┘
```

Narrow terminal (< 100 cols):
```
┌──────────────────────────────────┐
│ Status Bar                       │
├──────────────────────────────────┤
│ Conversation                     │
├──────────────────────────────────┤
│ Reasoning (3)                    │
│ ✓ Step 1 │ ● Step 2 │ ○ Step 3   │
├──────────────────────────────────┤
│ > input                          │
└──────────────────────────────────┘
```

## Success Criteria

1. Ctrl+R toggles reasoning panel visibility
2. Panel shows when reasoning_steps present and show_reasoning is true
3. Step status indicators display correctly
4. Panel positions based on terminal width
5. All tests pass

## Current Status

**Status**: Complete
