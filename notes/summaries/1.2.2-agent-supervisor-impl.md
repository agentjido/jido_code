# Summary: Task 1.2.2 - Agent Supervisor Implementation

## Overview

Implemented agent lifecycle management functions for the AgentSupervisor: `start_agent/1`, `stop_agent/1`, and `lookup_agent/1`. Agents register in AgentRegistry and use transient restart strategy.

## Changes Made

### New Files Created
- `lib/jido_code/test_agent.ex` - Simple GenServer for testing lifecycle
- `test/jido_code/agent_supervisor_test.exs` - 15 tests for agent lifecycle

### Modified Files
- `lib/jido_code/agent_supervisor.ex` - Added start_agent/1, stop_agent/1, lookup_agent/1

### JidoCode.AgentSupervisor Module Updates

**New Public API:**
- `start_agent/1` - Start an agent with name, module, args
- `stop_agent/1` - Stop agent by pid or name
- `lookup_agent/1` - Find agent pid by name

**Agent Specification:**
```elixir
%{
  name: :my_agent,        # Registry key for lookup
  module: MyAgent,        # GenServer module
  args: []                # Init arguments (optional)
}
```

**Registration:**
- Agents register via `{:via, Registry, {JidoCode.AgentRegistry, name}}`
- Lookup returns `{:ok, pid}` or `{:error, :not_found}`

**Restart Strategy:**
- `:transient` - restart only on abnormal exit
- Crashed agents are restarted automatically
- Normal exits (`:normal`) are not restarted

### JidoCode.TestAgent Module

Simple GenServer for testing agent lifecycle:
- `get_state/1` - Get current state
- `set_state/2` - Update state
- `crash/1` - Trigger intentional crash
- `stop/1` - Request normal shutdown

### Tests Added (15 tests)

**start_agent/1 tests:**
- Agent starts successfully
- Agent registers in AgentRegistry
- Returns error for duplicate name
- Returns error for invalid spec
- Increments child count

**stop_agent/1 tests:**
- Stops agent by pid
- Stops agent by name
- Returns error for unknown pid
- Returns error for unknown name
- Decrements child count

**lookup_agent/1 tests:**
- Returns pid for existing agent
- Returns error for non-existent agent

**Restart behavior tests:**
- Agent recovers from crash (transient restart)
- Agent with normal exit is not restarted

**TestAgent tests:**
- Can get and set state

## Verification

- `mix test` - 39 tests, 0 failures (15 new)
- Crash recovery verified via TestAgent.crash/1

## Usage Example

```elixir
# Start an agent
{:ok, pid} = JidoCode.AgentSupervisor.start_agent(%{
  name: :my_agent,
  module: JidoCode.TestAgent,
  args: []
})

# Lookup by name
{:ok, ^pid} = JidoCode.AgentSupervisor.lookup_agent(:my_agent)

# Stop by name
:ok = JidoCode.AgentSupervisor.stop_agent(:my_agent)

# Or stop by pid
:ok = JidoCode.AgentSupervisor.stop_agent(pid)
```

## Notes

- TestAgent is included in main lib for now; could be moved to test/support later
- The crash log during tests is expected (testing restart behavior)

## Next Steps

Task 1.3.1 - Settings File Structure (two-level JSON configuration)
