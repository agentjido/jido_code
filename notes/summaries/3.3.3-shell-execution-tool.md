# Summary: 3.3.3 Shell Execution Tool

## Overview

Implemented a shell execution tool that enables the LLM agent to run shell commands in the project directory. The tool captures exit codes, output, and enforces configurable timeouts.

## Files Created

### lib/jido_code/tools/handlers/shell.ex

Handler module containing:

- `RunCommand` - Executes shell commands with timeout support
  - Uses `System.cmd/3` with `cd:` option to run in project directory
  - Empty `env: []` prevents leaking sensitive environment variables
  - `stderr_to_stdout: true` merges stderr into stdout for simplicity
  - Task-based timeout enforcement with yield/shutdown
  - Returns JSON with exit_code, stdout, stderr

Shared helper for getting project_root from context.

### lib/jido_code/tools/definitions/shell.ex

Tool definition module providing:
- `all/0` - Returns shell tools for registration
- `run_command/0` - Tool definition with command, args, timeout params

### test/jido_code/tools/handlers/shell_test.exs

13 tests covering:
- Simple command execution
- Exit code capture
- Running in project directory
- Multiple arguments
- Non-existent command handling
- Stderr capture (merged)
- Timeout enforcement
- Missing arguments

### test/jido_code/tools/definitions/shell_test.exs

7 tests covering:
- Tool definition correctness
- Schema validation
- Executor integration
- Command failure handling
- LLM message conversion

## Design Decisions

1. **Merged Stderr**: For POC simplicity, stderr is merged into stdout using `stderr_to_stdout: true`. This is sufficient for most LLM use cases where the combined output is analyzed.

2. **Empty Environment**: Commands run with `env: []` to prevent leaking sensitive environment variables from the host process.

3. **Task-Based Timeout**: Uses `Task.async` with `Task.yield/2` and `Task.shutdown/2` for clean timeout handling. Returns exit_code=-1 and informative message on timeout.

4. **Implicit Try/Catch**: Uses Elixir's implicit try with catch clause at function level for cleaner code (per Credo recommendation).

5. **Command Allowlist Deferred**: The optional command allowlist/blocklist feature (3.3.3.6) is deferred to a future enhancement as it wasn't critical for POC.

## Test Results

```
20 tests (13 handlers + 7 definitions), 0 failures
643 total tests, 0 failures
```

All Credo checks pass with `--strict` flag.

## What's Next

Task 3.4.1: Tool Call Display - Display tool calls and results in the TUI for transparency.
