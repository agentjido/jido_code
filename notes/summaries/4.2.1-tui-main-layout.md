# Summary: 4.2.1 TUI Main Layout Structure

## Overview

Implemented the primary view function for the TUI with a three-pane layout: status bar at top, conversation area in the middle, and input bar at bottom. The layout uses TermUI's stack-based composition with proper styling for different UI elements.

## Implementation

### Architecture

The view function returns a vertical stack with three children:

```
┌──────────────────────────────────────┐
│ Status Bar                           │  provider:model | Status | Ctrl+C: Quit
├──────────────────────────────────────┤
│                                      │
│ Conversation Area                    │  Messages or welcome/config prompt
│                                      │
├──────────────────────────────────────┤
│ > input buffer                       │  Green prompt + typed text
└──────────────────────────────────────┘
```

### Status Bar

- Displays provider and model: `anthropic:claude-3-5-sonnet`
- Shows status indicator with text: Idle, Processing..., Error, Not Configured
- Shows CoT indicator when reasoning steps are active: `CoT: 1/3`
- Displays keyboard hints: `Ctrl+C: Quit`
- Blue background with white text

### Conversation Area

- Shows welcome message when empty and configured
- Shows configuration instructions when unconfigured
- Displays messages with timestamps: `[HH:MM] You: message`
- User messages styled in cyan
- Assistant messages styled in white
- System messages styled in bright_black (gray)

### Input Bar

- Green bold prompt: `> `
- Displays current input buffer content
- Horizontal stack layout

## Files Changed

- `lib/jido_code/tui.ex` - Updated view/1 and added render helper functions
- `test/jido_code/tui_test.exs` - Added 13 new view tests (45 total)
- `notes/planning/proof-of-concept/phase-04.md` - Task marked complete
- `notes/features/4.2.1-tui-main-layout.md` - Planning document

## Tests Added

### View Structure Tests (13 tests)
- Three-pane vertical layout structure
- Status bar with blue background and content
- Status bar unconfigured state
- Status bar processing state
- CoT indicator when reasoning active
- Conversation area as stack
- Welcome message when configured
- Configuration message when unconfigured
- User messages with cyan styling
- Assistant messages with white styling
- Messages include timestamps
- Input bar with green prompt
- Input bar shows empty buffer

## Design Decisions

1. **Simple stacking**: Used basic vertical/horizontal stacks without constraints since TermUI NodeRenderer doesn't process constraint tuples yet
2. **Timestamp format**: Using `[HH:MM]` format for compactness
3. **CoT indicator**: Only shows when there are active reasoning steps
4. **Empty state handling**: Different messages for configured vs unconfigured states
5. **Color scheme**: Followed the plan's specifications (user: cyan, assistant: white, prompt: green)

## Technical Notes

### Styling Applied

| Element | Style |
|---------|-------|
| Status Bar | fg: white, bg: blue |
| User Messages | fg: cyan |
| Assistant Messages | fg: white |
| System Messages | fg: bright_black |
| Timestamps | Included in message text |
| Input Prompt | fg: green, attrs: [:bold] |

### Helper Functions Added

- `render_status_bar/1` - Status bar with config, status, CoT, hints
- `render_conversation/1` - Routes to empty or messages view
- `render_empty_conversation/1` - Welcome or config prompt
- `render_messages/1` - Maps messages to styled text nodes
- `render_message/1` - Formats individual message with timestamp
- `render_input_bar/1` - Prompt and buffer
- `format_config/1` - Config text formatting
- `format_status_indicator/1` - Status text
- `format_cot_indicator/1` - CoT progress text
- `format_timestamp/1` - DateTime to HH:MM string

## Next Steps

Task 4.2.2 will enhance message display:
- Text wrapping for long messages
- Auto-scroll to latest message
- Arrow key scrolling through history
